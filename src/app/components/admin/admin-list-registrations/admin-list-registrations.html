<div class="m-5">
  <div class="d-flex justify-content-between ">
    <h1>Registration List</h1>
    <mat-form-field>
      <mat-label>Filter</mat-label>
      <input matInput (keyup)="applyFilter($event)" placeholder="Search Registrations">
    </mat-form-field>
  </div>
  @if (loading) {
  <div class="loader-container">
    <mat-progress-bar mode="indeterminate"></mat-progress-bar>
  </div>
  }
  <div class="table-container">
    <table mat-table [dataSource]="dataSource" matSort (matSortChange)="onSortChange($event)" class="mat-elevation-z8 full-width-table">

    <ng-container matColumnDef="actions">
    <th mat-header-cell *matHeaderCellDef>Actions</th>
    <td mat-cell *matCellDef="let row">
      <button mat-icon-button [matMenuTriggerFor]="menu" aria-label="Row actions" >
        <mat-icon>more_vert</mat-icon>
      </button>
      <mat-menu #menu="matMenu">
        <button mat-menu-item (click)="onActionClick('Approve', row);">
          <mat-icon>check</mat-icon>
          <span>Approve</span>
        </button>
        <button mat-menu-item (click)="onActionClick('Reject', row);">
          <mat-icon>close</mat-icon>
          <span>Reject</span>
        </button>
        <button mat-menu-item (click)="onActionClick('View', row);">
          <mat-icon>visibility</mat-icon>
          <span>View</span>
        </button>
      </mat-menu>
    </td>
  </ng-container>
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>
        <td mat-cell *matCellDef="let el">
          {{ getFullName(el) }}
        </td>
      </ng-container>
  <ng-container matColumnDef="address">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Address</th>
        <td mat-cell *matCellDef="let el">{{ getFullAddress(el) }}</td>
      </ng-container>
      <ng-container matColumnDef="gender">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Gender</th>
        <td mat-cell *matCellDef="let el">{{ el.gender }}</td>
      </ng-container>
      <ng-container matColumnDef="dob">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Date of Birth</th>
        <td mat-cell *matCellDef="let el">{{ el.dob }}</td>
      </ng-container>

      <ng-container matColumnDef="maritalStatus">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>maritalStatus</th>
        <td mat-cell *matCellDef="let el">{{ el.maritalStatus }}</td>
      </ng-container>
      <ng-container matColumnDef="mobile">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>mobile</th>
        <td mat-cell *matCellDef="let el">{{ el.mobile }}</td>
      </ng-container>
      <ng-container matColumnDef="email">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>email</th>
        <td mat-cell *matCellDef="let el">{{ el.email }}</td>
      </ng-container>
      <ng-container matColumnDef="aadhaar">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>aadhaar</th>
        <td mat-cell *matCellDef="let el">{{ el.aadhaar }}</td>
      </ng-container>
      <ng-container matColumnDef="subCaste">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>subCaste</th>
        <td mat-cell *matCellDef="let el">{{ el.subCaste }}</td>
      </ng-container>
      <ng-container matColumnDef="qualification">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>qualification</th>
        <td mat-cell *matCellDef="let el">{{ el.qualification }}</td>
      </ng-container>
      <ng-container matColumnDef="fatherName">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>fatherName</th>
        <td mat-cell *matCellDef="let el">{{ el.fatherName }}</td>
      </ng-container>
      <ng-container matColumnDef="motherName">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>motherName</th>
        <td mat-cell *matCellDef="let el">{{ el.motherName }}</td>
      </ng-container>

      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Status</th>
        <td mat-cell *matCellDef="let el">
          <div [ngClass]="getClass(el.status)">
            {{ el.status }}
          </div>
        </td>
      </ng-container>


      <tr class="mat-header-row" mat-header-row *matHeaderRowDef="displayedColumns sticky: true"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
  </div>

  <mat-paginator [length]="totalRows" [pageSize]="pageSize" [pageSizeOptions]="[5, 10, 20]"
    (page)="onPageChange($event)">
  </mat-paginator>
</div>
